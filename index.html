<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>Ø¹Ù„Ø§Ø¡ Ø§Ù„Ø¯ÙŠÙ† - Ø§Ù„ØªØ­Ù‚Ù‚ Ø£Ùˆ Ø§Ø³ØªØ¹Ø§Ø¯Ø© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: 'Cairo', sans-serif;
      background: linear-gradient(180deg, #e0f2f1, #ffffff);
      text-align: center;
      padding: 50px 20px;
      color: #333;
    }
    .card {
      background: white;
      border-radius: 20px;
      padding: 40px 25px;
      max-width: 420px;
      margin: auto;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      animation: fadeIn 0.8s ease;
    }
    img.logo {
      width: 120px;
      height: 120px;
      border-radius: 20px;
      margin-bottom: 20px;
      object-fit: cover;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.15);
    }
    input {
      padding: 12px;
      width: 85%;
      border-radius: 10px;
      border: 1px solid #ccc;
      margin-top: 10px;
      font-size: 16px;
    }
    button {
      background-color: #00897b;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 12px;
      cursor: pointer;
      margin-top: 20px;
      font-size: 16px;
    }
    button:hover {
      background-color: #00796b;
    }
    p {
      font-size: 15px;
      line-height: 1.6;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body>
  <div class="card" id="content">
    <img src="https://qgwlcuxrudvdnmryajza.supabase.co/storage/v1/object/public/logo/logo.png"
         alt="Ø´Ø¹Ø§Ø± Ø¹Ù„Ø§Ø¡ Ø§Ù„Ø¯ÙŠÙ†"
         class="logo">
    <h2>Ø¬Ø§Ø±Ù Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø±Ø§Ø¨Ø·...</h2>
    <p>ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ù„Ø­Ø¸Ø©.</p>
  </div>

  <!-- Ù…ÙƒØªØ¨Ø© Supabase -->
  <script src="https://unpkg.com/@supabase/supabase-js"></script>

  <script>
    // âœ… ØªÙ‡ÙŠØ¦Ø© Supabase
    const supabase = window.supabase.createClient(
      'https://qgwlcuxrudvdnmryajza.supabase.co',
      'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFnd2xjdXhydWR2ZG5tcnlhanphIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDczMzczNTMsImV4cCI6MjA2MjkxMzM1M30.ulELQIWdOGcc28zMuobV6MzNmud9g1Fj5ZhbAku7m7E'
    );

    // âœ… Ù‚Ø±Ø§Ø¡Ø© Ù…Ø¹Ø§Ù…Ù„Ø§Øª Supabase (Ø­ØªÙ‰ Ù„Ùˆ Ø¬Ø§Ø¡Øª Ø¨Ø¹Ø¯ #)
    const search = window.location.search || window.location.hash;
    const params = new URLSearchParams(search.replace('#', '?'));
    const type = params.get('type');
    const content = document.getElementById('content');

    if (type === 'recovery') {
      // ğŸ§© ÙˆØ§Ø¬Ù‡Ø© Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
      content.innerHTML = `
        <img src="https://qgwlcuxrudvdnmryajza.supabase.co/storage/v1/object/public/logo/logo.png" alt="Ø´Ø¹Ø§Ø± Ø¹Ù„Ø§Ø¡ Ø§Ù„Ø¯ÙŠÙ†" class="logo">
        <h2>Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</h2>
        <p>ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø¬Ø¯ÙŠØ¯Ø© Ù„Ø­Ø³Ø§Ø¨Ùƒ.</p>
        <input type="password" id="newPassword" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©"><br>
        <button onclick="resetPassword()">ØªØ£ÙƒÙŠØ¯</button>
        <p id="msg"></p>
      `;
    } else if (type === 'signup') {
      // ğŸ§© ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ø¨Ø¹Ø¯ Ø§Ù„ØªØ³Ø¬ÙŠÙ„
      content.innerHTML = `
        <img src="https://qgwlcuxrudvdnmryajza.supabase.co/storage/v1/object/public/logo/logo.png" alt="Ø´Ø¹Ø§Ø± Ø¹Ù„Ø§Ø¡ Ø§Ù„Ø¯ÙŠÙ†" class="logo">
        <h2>ØªÙ… ØªØ£ÙƒÙŠØ¯ Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ âœ…</h2>
        <p>ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù„Ø§Ø¡ Ø§Ù„Ø¯ÙŠÙ† ÙˆØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„.</p>
        <a href="alaaaldin://login"><button>ÙØªØ­ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</button></a>
      `;
    } else {
      // ğŸ”´ ÙÙŠ Ø­Ø§Ù„ Ø§Ù„Ø±Ø§Ø¨Ø· ØºÙŠØ± ØµØ§Ù„Ø­ Ø£Ùˆ Ù…Ù†ØªÙ‡ÙŠ
      content.innerHTML = `
        <img src="https://qgwlcuxrudvdnmryajza.supabase.co/storage/v1/object/public/logo/logo.png" alt="Ø´Ø¹Ø§Ø± Ø¹Ù„Ø§Ø¡ Ø§Ù„Ø¯ÙŠÙ†" class="logo">
        <h2>Ø±Ø§Ø¨Ø· ØºÙŠØ± ØµØ§Ù„Ø­ âŒ</h2>
        <p>ÙŠØ¨Ø¯Ùˆ Ø£Ù† Ø§Ù„Ø±Ø§Ø¨Ø· Ù…Ù†ØªÙ‡ÙŠ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ© Ø£Ùˆ ØºÙŠØ± ØµØ­ÙŠØ­.</p>
      `;
    }

    // âš™ï¸ Ø¯Ø§Ù„Ø© Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
    async function resetPassword() {
      const newPassword = document.getElementById('newPassword').value.trim();
      const msg = document.getElementById('msg');
      if (!newPassword) {
        msg.textContent = 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø¬Ø¯ÙŠØ¯Ø©';
        msg.style.color = 'red';
        return;
      }

      try {
        const { error } = await supabase.auth.updateUser({ password: newPassword });
        if (error) throw error;

        msg.textContent = 'âœ… ØªÙ… ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¨Ù†Ø¬Ø§Ø­! ÙŠÙ…ÙƒÙ†Ùƒ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¢Ù†.';
        msg.style.color = 'green';

        // ÙŠÙ…ÙƒÙ† Ø¨Ø¹Ø¯ Ø§Ù„Ù†Ø¬Ø§Ø­ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù„Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¨Ø¹Ø¯ 3 Ø«ÙˆØ§Ù†Ù
        setTimeout(() => {
          window.location.href = "alaaaldin://login";
        }, 3000);

      } catch (err) {
        msg.textContent = 'âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØºÙŠÙŠØ±: ' + err.message;
        msg.style.color = 'red';
      }
    }
  </script>
</body>
</html>
